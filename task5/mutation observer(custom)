function autoTypeAndCreateAndDetect(text) {
    // Find the lyrics textarea
    const textarea = document.querySelector('textarea[data-testid="lyrics-input-textarea"]');
    // Find the "Full Song" button by its text
    const button = Array.from(document.querySelectorAll('button')).find(btn =>
        btn.textContent.trim().toLowerCase().includes('full song')
    );

    if (!textarea || !button) {
        console.error("Lyrics textarea or Full Song button not found!");
        return;
    }

    textarea.value = text;
    textarea.dispatchEvent(new Event('input', { bubbles: true }));

    // Observe for song creation in workspace
    observeCreatedSong((song) => {
        console.log("Detected created song:", song);
    });

    setTimeout(() => {
        button.click();
        console.log("Song creation triggered!");
    }, 500);
}

function observeCreatedSong(callback) {
    // Workspace container
    const observerTarget = document.querySelector('.custom-scrollbar-semitransparent');
    if (!observerTarget) {
        console.error("Workspace container not found!");
        return;
    }

    const observer = new MutationObserver((mutationsList) => {
        for (const mutation of mutationsList) {
            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                mutation.addedNodes.forEach(node => {
                    if (node.nodeType === 1) {
                        const title = node.querySelector?.('input[placeholder="Enter song title"]')?.value?.trim();
                        const lyrics = node.querySelector?.('textarea[data-testid="lyrics-input-textarea"]')?.value?.trim();
                        if (title || lyrics) {
                            callback({ title, lyrics });
                        }
                    }
                });
            }
        }
    });

    observer.observe(observerTarget, { childList: true, subtree: true });
}

// Example usage:
autoTypeAndCreateAndDetect("A mellow jazz tune with smooth saxophone and soft drums.");